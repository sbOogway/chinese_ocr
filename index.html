<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Device Camera Demo</title>
    <style>
      video {
        width: 100%;
        max-width: 600px;
      }
      button {
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h2>Live Camera Feed</h2>
    <video id="camera" autoplay playsinline></video>
    <br />
    <button id="snap">Take Photo</button>
    <canvas id="snapshot" style="display: none"></canvas>
    <img id="photo" alt="Captured image" />

    <script>
      const video = document.getElementById("camera");
      const snapBtn = document.getElementById("snap");
      const canvas = document.getElementById("snapshot");
      const photo = document.getElementById("photo");

      // Request access to the camera
      async function startCamera() {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "user" }, // 'environment' for rear camera on mobile
            audio: false,
          });
          video.srcObject = stream;
        } catch (err) {
          console.error("Error accessing camera:", err);
          alert("Could not access the camera. Please allow permission.");
        }
      }

      // Capture a frame from the video
      function takePhoto() {
        const ctx = canvas.getContext("2d");
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        // Convert to data URL and show the image
        photo.src = canvas.toDataURL("image/png");
      }

      snapBtn.addEventListener("click", takePhoto);
      startCamera();
    </script>
  </body>
</html>
